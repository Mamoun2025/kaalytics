<!--
KAALYTICS - Text Scramble Effect
=================================
Animation de texte avec effet scramble/decode
Source: github.com/ARITRA69/scramble-text
-->

<div class="scramble-demo">
    <div class="scramble-container">
        <h1 class="scramble-title">
            <span class="scramble-text" data-text="KAALYTICS">KAALYTICS</span>
        </h1>
        <p class="scramble-subtitle">
            <span class="scramble-text" data-text="Intelligence Artificielle pour votre Flotte">Intelligence Artificielle pour votre Flotte</span>
        </p>
        <div class="scramble-words">
            <span class="scramble-word" id="rotatingWord">Innovation</span>
        </div>
        <button class="scramble-btn" id="scrambleBtn">Scramble!</button>
    </div>
</div>

<style>
:root {
    --emerald: #10b981;
    --emerald-dim: rgba(16, 185, 129, 0.2);
    --teal: #0d9488;
    --bg-void: #030a08;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

.scramble-demo {
    width: 100%;
    min-height: 100vh;
    background: var(--bg-void);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
}

.scramble-container {
    text-align: center;
    max-width: 800px;
}

.scramble-title {
    font-size: clamp(3rem, 10vw, 7rem);
    font-weight: 900;
    letter-spacing: -0.02em;
    margin-bottom: 1rem;
}

.scramble-text {
    display: inline-block;
    background: linear-gradient(135deg, var(--emerald) 0%, var(--teal) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-family: 'Courier New', monospace;
}

.scramble-subtitle {
    font-size: 1.5rem;
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 2rem;
}

.scramble-subtitle .scramble-text {
    background: none;
    -webkit-text-fill-color: inherit;
    color: inherit;
}

.scramble-words {
    margin-bottom: 2rem;
}

.scramble-word {
    display: inline-block;
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--emerald);
    font-family: 'Courier New', monospace;
    padding: 0.5rem 1rem;
    background: var(--emerald-dim);
    border-radius: 8px;
    min-width: 300px;
}

.scramble-btn {
    padding: 1rem 3rem;
    font-size: 1rem;
    font-weight: 600;
    color: var(--bg-void);
    background: linear-gradient(135deg, var(--emerald), var(--teal));
    border: none;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.scramble-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 30px var(--emerald-dim);
}

/* Effet de clignotement pour le curseur */
.scramble-cursor {
    display: inline-block;
    width: 3px;
    height: 1em;
    background: var(--emerald);
    margin-left: 2px;
    animation: blink 0.8s step-end infinite;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* Responsive */
@media (max-width: 768px) {
    .scramble-word {
        font-size: 1.5rem;
        min-width: 200px;
    }
}
</style>

<script>
(function() {
    // Caracteres pour l'effet scramble
    const chars = '!<>-_\\/[]{}=+*^?#@$%&ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';

    // Classe TextScramble
    class TextScramble {
        constructor(el) {
            this.el = el;
            this.chars = chars;
            this.queue = [];
            this.frame = 0;
            this.frameRequest = null;
            this.resolve = null;
        }

        setText(newText) {
            const oldText = this.el.textContent;
            const length = Math.max(oldText.length, newText.length);
            this.queue = [];

            for (let i = 0; i < length; i++) {
                const from = oldText[i] || '';
                const to = newText[i] || '';
                const start = Math.floor(Math.random() * 20);
                const end = start + Math.floor(Math.random() * 20);
                this.queue.push({ from, to, start, end });
            }

            cancelAnimationFrame(this.frameRequest);
            this.frame = 0;

            return new Promise(resolve => {
                this.resolve = resolve;
                this.update();
            });
        }

        update() {
            let output = '';
            let complete = 0;

            for (let i = 0; i < this.queue.length; i++) {
                let { from, to, start, end, char } = this.queue[i];

                if (this.frame >= end) {
                    complete++;
                    output += to;
                } else if (this.frame >= start) {
                    if (!char || Math.random() < 0.28) {
                        char = this.randomChar();
                        this.queue[i].char = char;
                    }
                    output += `<span style="color: rgba(16, 185, 129, 0.5)">${char}</span>`;
                } else {
                    output += from;
                }
            }

            this.el.innerHTML = output;

            if (complete === this.queue.length) {
                this.resolve();
            } else {
                this.frameRequest = requestAnimationFrame(() => this.update());
                this.frame++;
            }
        }

        randomChar() {
            return this.chars[Math.floor(Math.random() * this.chars.length)];
        }
    }

    // Mots rotatifs
    const words = ['Innovation', 'Performance', 'Efficacite', 'Intelligence', 'Optimisation', 'Automatisation'];
    let wordIndex = 0;

    const rotatingWord = document.getElementById('rotatingWord');
    const scrambleBtn = document.getElementById('scrambleBtn');

    if (rotatingWord) {
        const fx = new TextScramble(rotatingWord);

        const rotateWord = () => {
            fx.setText(words[wordIndex]).then(() => {
                setTimeout(rotateWord, 2000);
            });
            wordIndex = (wordIndex + 1) % words.length;
        };

        // Demarrer la rotation automatique
        setTimeout(rotateWord, 1000);

        // Bouton pour forcer le scramble
        if (scrambleBtn) {
            scrambleBtn.addEventListener('click', () => {
                wordIndex = (wordIndex + 1) % words.length;
                fx.setText(words[wordIndex]);
            });
        }
    }

    // Scramble au survol des textes
    document.querySelectorAll('.scramble-text').forEach(el => {
        const originalText = el.dataset.text;
        const fx = new TextScramble(el);

        el.addEventListener('mouseenter', () => {
            fx.setText(originalText);
        });
    });
})();
</script>
